# ä»æºå¤´æ²»ç†ï¼šé•œåƒå’Œå®¹å™¨å®‰å…¨
<aside>
ğŸ’¡ è¿™é‡Œä¸»è¦ä¼šåŒ…å«ä¸¤ä¸ªæ–¹é¢ï¼šå®¹å™¨é•œåƒå†…å®¹å®‰å…¨æ€§çš„ä¿éšœï¼›å®¹å™¨é•œåƒåˆ†å‘è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§ä¿éšœã€‚

</aside>

## å®¹å™¨é•œåƒå†…å®¹å®‰å…¨æ€§çš„ä¿éšœ

### ä»€ä¹ˆæ˜¯å®¹å™¨é•œåƒ

ä¹‹å‰ä»‹ç»äº† Skopeo å·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ— éœ€åå°è¿›ç¨‹å³å¯å®Œæˆæ‰€æœ‰åŠŸèƒ½ã€‚æˆ‘ä»¬ä½¿ç”¨ Skopeo å·¥å…·è·å–ä¸€ä¸ªÂ `debian`Â çš„å®¹å™¨é•œåƒï¼Œæ”¾å…¥æœ¬åœ°ç›®å½•ä¸­ã€‚

```yaml
[root@sddk ~]# skopeo copy docker://index.docker.io/library/debian dir:./debian
[root@sddk ~]# tree debian/
debian/
â”œâ”€â”€ 04fbdaf87a6a632f3f2e8d9f53f97b2813d9e4111c62e21d56454460f477075b
â”œâ”€â”€ 0c6b8ff8c37e92eb1ca65ed8917e818927d5bf318b6f18896049b5d9afc28343
â”œâ”€â”€ manifest.json
â””â”€â”€ version

0 directories, 4 files
```

å¯ä»¥çœ‹åˆ°è·å–åˆ°çš„å®¹å™¨é•œåƒéƒ½æ˜¯ä¸€ç³»åˆ—çš„æ–‡ä»¶ã€‚Â `manifest.json`Â æ–‡ä»¶æ ‡è¯†äº†è¿™ä¸ª"å®¹å™¨é•œåƒ"çš„å…·ä½“ç»„æˆã€‚

```json
[root@sddk ~]# cat debian/manifest.json 
{
   "schemaVersion": 2,
   "mediaType": "application/vnd.docker.distribution.manifest.v2+json",
   "config": {
      "mediaType": "application/vnd.docker.container.image.v1+json",
      "size": 1462,
      "digest": "sha256:04fbdaf87a6a632f3f2e8d9f53f97b2813d9e4111c62e21d56454460f477075b"
   },
   "layers": [
      {
         "mediaType": "application/vnd.docker.image.rootfs.diff.tar.gzip",
         "size": 54917164,
         "digest": "sha256:0c6b8ff8c37e92eb1ca65ed8917e818927d5bf318b6f18896049b5d9afc28343"
      }
   ]
}
```

Â `schemaVersion`Â å’ŒÂ `mediaType`Â è¡¨ç¤ºå®ƒå½“å‰ä½¿ç”¨çš„[è§„èŒƒ](https://docs.docker.com/registry/spec/manifest-v2-2/)ã€‚

`config`Â å’ŒÂ `layers`Â å­—æ®µåˆ†åˆ«è¡¨æ˜äº†æ­¤å®¹å™¨é•œåƒçš„é…ç½®å’Œé•œåƒä¸­åŒ…å«çš„å…·ä½“å†…å®¹ã€‚å®ƒä»¬çš„Â `mediaType`Â ä¹Ÿè¡¨ç¤ºäº†è¯¥æ–‡ä»¶çš„å…·ä½“æ ¼å¼ã€‚

- `application/vnd.docker.container.image.v1+json`ï¼šè¯´æ˜æ­¤æ–‡ä»¶æ˜¯ JSON æ ¼å¼
- `application/vnd.docker.image.rootfs.diff.tar.gzip`ï¼šè¯´æ˜æ­¤æ–‡ä»¶æ˜¯Â `tar.gzip`Â çš„å‹ç¼©åŒ…

æ¯”å¦‚ï¼Œå½“æˆ‘ä»¬å¯¹Â `layers`Â ä¸­æè¿°çš„æ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œä¼šå‘ç°å…¶ä¸­åŒ…å«äº† rootfs

```bash
[root@sddk ~]# tar -zxf debian/0c6b8ff8c37e92eb1ca65ed8917e818927d5bf318b6f18896049b5d9afc28343 -C debian-rootfs/
[root@sddk ~]# ls -l debian/debian-rootfs/
æ€»ç”¨é‡ 12
drwxr-xr-x.  2 root root 4096 1æœˆ  25 08:00 bin
drwxr-xr-x.  2 root root    6 12æœˆ 12 01:25 boot
drwxr-xr-x.  2 root root    6 1æœˆ  25 08:00 dev
drwxr-xr-x. 30 root root 4096 1æœˆ  25 08:00 etc
drwxr-xr-x.  2 root root    6 12æœˆ 12 01:25 home
drwxr-xr-x.  8 root root   96 1æœˆ  25 08:00 lib
drwxr-xr-x.  2 root root   34 1æœˆ  25 08:00 lib64
drwxr-xr-x.  2 root root    6 1æœˆ  25 08:00 media
drwxr-xr-x.  2 root root    6 1æœˆ  25 08:00 mnt
drwxr-xr-x.  2 root root    6 1æœˆ  25 08:00 opt
drwxr-xr-x.  2 root root    6 12æœˆ 12 01:25 proc
drwx------.  2 root root   37 1æœˆ  25 08:00 root
drwxr-xr-x.  3 root root   30 1æœˆ  25 08:00 run
drwxr-xr-x.  2 root root 4096 1æœˆ  25 08:00 sbin
drwxr-xr-x.  2 root root    6 1æœˆ  25 08:00 srv
drwxr-xr-x.  2 root root    6 12æœˆ 12 01:25 sys
drwxrwxrwt.  2 root root    6 1æœˆ  25 08:00 tmp
drwxr-xr-x. 11 root root  120 1æœˆ  25 08:00 usr
drwxr-xr-x. 11 root root  139 1æœˆ  25 08:00 var
```

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œ**å®¹å™¨é•œåƒå®é™…ä¸Šå°±æ˜¯ä¸€äº›æŒ‰ç…§å›ºå®šè§„èŒƒç»„ç»‡èµ·æ¥çš„æ–‡ä»¶å’Œé…ç½®**ã€‚

### ä»€ä¹ˆæ˜¯ SBOM

è‡³äºå®¹å™¨é•œåƒä¸­çš„å†…å®¹å¦‚ä½•ä¿è¯å…¶å®‰å…¨æ€§ï¼Œè¿™é‡Œéœ€è¦å¼•å…¥ä¸€ä¸ªæ¦‚å¿µå«ä½œ SBOM*ï¼ˆè½¯ä»¶ææ–™æ¸…å•/Software Bill of Materialsï¼‰*ã€‚

å…·ä½“æ¥è¯´ SBOM å°±æ˜¯ä¸€ä»½å¯ç”¨äºè¡¨æ˜Â **ç”¨äºæ„å»ºè½¯ä»¶çš„ç›¸å…³ç»„ä»¶åŠå…¶ä¾èµ–é¡¹çš„è¯¦ç»†ä¿¡æ¯åŠè½¯ä»¶è‡ªèº«å…ƒæ•°æ®ä¿¡æ¯** çš„æ¸…å•æ–‡ä»¶ã€‚ è¿™å…¶ä¸­ä¸ä»…åŒ…æ‹¬å¼€æºè½¯ä»¶ï¼Œä¹Ÿå¯ä»¥åŒ…å«å®ƒç”¨åˆ°çš„ä¸“æœ‰è½¯ä»¶ç­‰ã€‚

SBOM çš„ä¸¤å¤§ä¸»è¦ä½¿ç”¨åœºæ™¯å°±æ˜¯

- **ä¿è¯äº§å“å®Œæ•´æ€§**ã€‚é€šè¿‡ SBOM ä½¿å¾—æ— è®ºè½¯ä»¶çš„æä¾›å•†æˆ–è€…ä½¿ç”¨è€…ï¼ˆæˆ–æ¶ˆè´¹è€…ï¼‰éƒ½å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“å½“å‰è½¯ä»¶çš„ç»„æˆï¼Œä¹Ÿå¯ä»¥æ›´å¥½åœ°ç¡®ä¿è½¯ä»¶ç»„ä»¶çš„å®Œæ•´æ€§ã€‚
- **ä¾›åº”é“¾å®‰å…¨ç®¡ç†**ã€‚é€šè¿‡ SBOM å¯ä»¥æ›´åŠ æ¸…æ¥šåœ°äº†è§£åˆ°å½“å‰è½¯ä»¶çš„ç›¸å…³ç»„ä»¶åŠå…¶ä¾èµ–ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿åœ°ç®¡ç†å½“å‰è½¯ä»¶çš„ä¸Šä¸‹æ¸¸å…³ç³»ã€‚è¿™å¯¹äºä¸‹æ¸¸ç”¨æˆ·è€Œè¨€ï¼Œå¯ä»¥é€šè¿‡ SBOM æ›´æ–¹ä¾¿åœ°è¯†åˆ«å®‰å…¨æ¼æ´ï¼Œä»¥åŠè¿›è¡Œä¿®å¤ã€‚

äº‹å®ä¸Šï¼ŒSBOM æ˜¯ä¸€ç§ç»Ÿç§°ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå…¶å®æœ‰å¾ˆå¤šç§è§„èŒƒï¼Œä¸åŒçš„è§„èŒƒå’Œæ ‡å‡†æœ‰è‡ªå·±çš„ä¸€äº›ç‰¹æ®Šä½œç”¨ã€‚ä¸è¿‡å®ƒä»¬é€šå¸¸éƒ½åŒ…å«ä»¥ä¸‹ç»„æˆ

- ä½œè€…ä¿¡æ¯
- åˆå§‹åˆ›å»ºå’Œæœ€åæ›´æ–°æ—¶é—´æˆ³
- ä¾›åº”å•†ä¿¡æ¯
- ç»„ä»¶åç§°
- ç‰ˆæœ¬ä¿¡æ¯
- ç»„ä»¶çš„å“ˆå¸Œå€¼
- å”¯ä¸€æ ‡è¯†ç¬¦
- ä¸è½¯ä»¶çš„å…³ç³»

æ¨èä¸€ä¸ªåŒ…å«æ¼æ´è¯†åˆ«èƒ½åŠ›çš„è§„èŒƒï¼šOWASPï¼ˆOpen Web Application Security ProjectÂ®ï¼‰ åŸºé‡‘ä¼š çš„Â [CycloneDX](https://cyclonedx.org/)

![https://cyclonedx.org/theme/assets/images/CycloneDX-Object-Model-Swimlane.svg](https://cyclonedx.org/theme/assets/images/CycloneDX-Object-Model-Swimlane.svg)

### ä¸ºå®¹å™¨é•œåƒç”Ÿæˆ SBOM

ä»‹ç»å¦ä¸€ä¸ªå·¥å…·ï¼Œæ¥è‡ª Anchore, Inc. çš„Â [syft](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fanchore%2Fsyft)ã€‚å®ƒæœ€ä¸»è¦çš„ä½œç”¨å°±æ˜¯ä¸ºå®¹å™¨é•œåƒç”Ÿæˆ SBOMï¼Œå¹¶ä¸”æ”¯æŒå¤šç§ç±»å‹çš„è¾“å‡ºã€‚

ä½¿ç”¨äºŒè¿›åˆ¶è¿›è¡Œå®‰è£…

```bash
[root@sddk ~]# wget https://github.com/anchore/syft/releases/download/v0.36.0/syft_0.36.0_linux_amd64.tar.gz
[root@sddk ~]# tar -zxf syft_0.36.0_linux_amd64.tar.gz
[root@sddk ~]# mv syft /usr/local/bin/
[root@sddk ~]# syft --version
syft 0.36.0
```

æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨æ­¤å·¥å…·ä¸ºå®¹å™¨é•œåƒç”Ÿæˆ SBOM ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¾ƒæ—§çš„é•œåƒç‰ˆæœ¬ä½œä¸ºç¤ºä¾‹ï¼Œå®ƒå·²ç»è¿‡äº†ç»´æŠ¤å‘¨æœŸï¼Œè¿™æ ·æ¯”è¾ƒæ–¹ä¾¿å‘ç°å…¶ä¸­çš„å®‰å…¨æ¼æ´ã€‚

```bash
[root@sddk ~]# syft --version
syft 0.36.0
[root@sddk ~]# syft alpine:3.10
 âœ” Pulled image            
 âœ” Loaded image            
 âœ” Parsed image            
 âœ” Cataloged packages      [14 packages]

NAME                    VERSION      TYPE 
alpine-baselayout       3.1.2-r0     apk   
alpine-keys             2.1-r2       apk   
apk-tools               2.10.6-r0    apk   
busybox                 1.30.1-r5    apk   
ca-certificates-cacert  20191127-r2  apk   
libc-utils              0.7.1-r0     apk   
libcrypto1.1            1.1.1k-r0    apk   
libssl1.1               1.1.1k-r0    apk   
libtls-standalone       2.9.1-r0     apk   
musl                    1.1.22-r4    apk   
musl-utils              1.1.22-r4    apk   
scanelf                 1.2.3-r0     apk   
ssl_client              1.30.1-r5    apk   
zlib                    1.2.11-r1    apk
```

æ‰§è¡Œä»¥ä¸Šå‘½ä»¤å¯ä»¥çœ‹åˆ°ï¼Œsyft ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†å½“å‰å®¹å™¨é•œåƒä¸­æ‰€åŒ…å«çš„å„è½¯ä»¶åŠå…¶ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚

ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆç¬¦åˆ CycloneDX è§„èŒƒçš„ SBOM

```bash
[root@sddk ~]# syft alpine:3.10 -o cyclone-json
```

### ä½¿ç”¨ SBOM å‘ç°å®¹å™¨é•œåƒä¸­çš„æ¼æ´

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªæ¥è‡ª Anchore, Inc. çš„å·¥å…·ï¼Œ[grype](https://github.com/anchore/grype)Â æ ¹æ® SBOM æ¥è¿›è¡Œå®‰å…¨æ¼æ´çš„æ‰«æã€‚

```bash
[root@sddk ~]# wget -q https://github.com/anchore/grype/releases/download/v0.32.0/grype_0.32.0_linux_amd64.tar.gz
[root@sddk ~]# tar -zxf grype_0.32.0_linux_amd64.tar.gz
[root@sddk ~]# mv grype /usr/local/bin/
[root@sddk ~]# grype version
Application:          grype
Version:              0.32.0
Syft Version:         v0.36.0
BuildDate:            2022-01-20T18:48:06Z
GitCommit:            3ba7e56e42fddca0fd944986596068e429d448fa
GitTreeState:         clean
Platform:             linux/amd64
GoVersion:            go1.16.13
Compiler:             gc
Supported DB Schema:  3
```

å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬ä¾¿å¯åˆ©ç”¨ grype æ ¹æ® SBOM æ¥è¿›è¡Œæ¼æ´æ‰«æäº†ã€‚æ³¨æ„ï¼šå½“å‰ grype ä»…æ”¯æŒ Syft ç”Ÿæˆçš„ JSON æ ¼å¼çš„ SBOMã€‚æ‰€ä»¥æˆ‘ä»¬ä¸ºå®ƒå¢åŠ Â `o json`Â çš„é€‰é¡¹ã€‚

```bash
[root@sddk ~]# syft alpine:3.10 -o json > /tmp/alpine-3.10-x-sbom.json
 âœ” Loaded image            
 âœ” Parsed image            
 âœ” Cataloged packages      [14 packages]

[root@sddk ~]# grype sbom:/tmp/alpine-3.10-x-sbom.json
 âœ” Vulnerability DB        [updated]
 âœ” Scanned image           [25 vulnerabilities]
NAME          INSTALLED  FIXED-IN   VULNERABILITY   SEVERITY 
apk-tools     2.10.6-r0  2.10.7-r0  CVE-2021-36159  Critical  
busybox       1.30.1-r5             CVE-2021-42374  Medium    
busybox       1.30.1-r5             CVE-2021-42380  High      
busybox       1.30.1-r5             CVE-2021-42381  High      
busybox       1.30.1-r5             CVE-2021-42382  High      
busybox       1.30.1-r5             CVE-2021-42379  High      
busybox       1.30.1-r5             CVE-2021-42384  High      
busybox       1.30.1-r5             CVE-2021-42385  High      
busybox       1.30.1-r5             CVE-2021-42386  High      
busybox       1.30.1-r5             CVE-2021-42376  Medium    
busybox       1.30.1-r5             CVE-2021-42378  High      
libcrypto1.1  1.1.1k-r0             CVE-2021-3712   High      
libcrypto1.1  1.1.1k-r0             CVE-2021-3711   Critical  
libssl1.1     1.1.1k-r0             CVE-2021-3711   Critical  
libssl1.1     1.1.1k-r0             CVE-2021-3712   High      
ssl_client    1.30.1-r5             CVE-2021-42374  Medium    
ssl_client    1.30.1-r5             CVE-2021-42382  High      
ssl_client    1.30.1-r5             CVE-2021-42385  High      
ssl_client    1.30.1-r5             CVE-2021-42386  High      
ssl_client    1.30.1-r5             CVE-2021-42380  High      
ssl_client    1.30.1-r5             CVE-2021-42384  High      
ssl_client    1.30.1-r5             CVE-2021-42376  Medium    
ssl_client    1.30.1-r5             CVE-2021-42378  High      
ssl_client    1.30.1-r5             CVE-2021-42379  High      
ssl_client    1.30.1-r5             CVE-2021-42381  High
```

å¯ä»¥çœ‹åˆ°ä½¿ç”¨ grype æ ¹æ® SBOM å·²ç»æ‰«æåˆ°äº†å®¹å™¨é•œåƒä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´ï¼Œå¹¶ä¸”ä¹Ÿåˆ—å‡ºäº†æ¼æ´ä¿¡æ¯åŠæ¼æ´ç­‰çº§ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ç›¸å…³çš„æ¼æ´ä¿¡æ¯é‡‡å–å¯¹åº”çš„å¤„ç†æªæ–½ï¼Œæ¯”å¦‚å¯¹è¿™äº›ä¾èµ–è¿›è¡Œå‡çº§ç­‰ã€‚

ä»¥ä¸Šå°±æ˜¯åŸºäº SBOM å¯¹å®¹å™¨é•œåƒå®‰å…¨æ€§ä¿éšœçš„ä¸€ç§å…¸å‹æ‰‹æ®µï¼Œä¸Šè¿°æåˆ°çš„ä¸¤ä¸ªå·¥å…· syft å’Œ grype å¤§å®¶å¯ä»¥ç›´æ¥é›†æˆåˆ°å½“å‰çš„ CI/CD pipeline ä¸­ï¼Œä»¥ä¾¿äºä¿è¯å®¹å™¨é•œåƒçš„å®‰å…¨ã€‚

## å®¹å™¨é•œåƒåˆ†å‘è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§ä¿éšœ

åœ¨ä½¿ç”¨å®¹å™¨é•œåƒçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¯¹äºå®¹å™¨é•œåƒè€Œè¨€ï¼Œæˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„Â `<repo>:<tag>`Â çš„æ ¼å¼ï¼Œå¯¹äºå®¹å™¨é•œåƒè€Œè¨€å¹¶æ²¡æœ‰å®é™…æ„ä¹‰ã€‚ æˆ‘ä»¬å¯ä»¥è½»æ¾çš„é€šè¿‡ç±»ä¼¼Â `docker tag`Â ç­‰å‘½ä»¤å¯¹å®¹å™¨é•œåƒè¿›è¡Œé‡æ–° tag ã€‚çœŸæ­£å¯¹å®¹å™¨é•œåƒæœ‰æ ‡è¯†æ€§çš„å…¶å®æ˜¯å®ƒçš„å“ˆå¸Œå€¼ï¼Œä¹Ÿå¯ä»¥è¯´æˆæ˜¯æ‘˜è¦ã€‚

```bash
[root@sddk ~]# docker pull alpine@sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300
docker.io/library/alpine@sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300: Pulling from library/alpine
Digest: sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300
Status: Image is up to date for alpine@sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300
docker.io/library/alpine@sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300

[root@sddk ~]# docker image ls alpine@sha256:21a3deaa0d32a8057914f36584b5288d2e5ecc984380bc0118285c70fa8c9300
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
alpine       <none>    c059bfaa849c   2 months ago   5.59MB
[root@sddk ~]# docker image ls alpine:3.15
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
alpine       3.15      c059bfaa849c   2 months ago   5.59MB
```

é€šè¿‡ä»¥ä¸Šå‘½ä»¤å¯ä»¥å‘ç°ï¼Œä½¿ç”¨é•œåƒçš„æ‘˜è¦ä¿¡æ¯ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œ Pull æ“ä½œçš„ï¼Œå¹¶ä¸” Pull ä¸‹æ¥çš„é•œåƒå°±æ˜¯åŒä¸€ä¸ªã€‚é•œåƒåœ¨åˆ†å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé­åˆ°ç¯¡æ”¹æˆ–è€…ä¸‹è½½çš„æ–‡ä»¶ä¸å®Œæ•´ç­‰é—®é¢˜ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨é•œåƒåˆ†å‘è¿‡ç¨‹å¯¹å…¶è¿›è¡Œå®‰å…¨ä¿è¯äº†ã€‚

### Docker Content Trustï¼ˆDCTï¼‰

æœ€å¸¸è§„çš„å¯¹äºå®¹å™¨é•œåƒè¿›è¡Œæ•°å­—å‰é¢ä»¥ä¾¿è¿›è¡Œå®‰å…¨é˜²æŠ¤çš„æ–¹å¼å°±æ˜¯ Docker Content Trust äº†ï¼Œè¿™æ˜¯ Docker æœ€æ—©æå‡ºçš„ï¼Œå¹¶ä¸”ä» Docker CE v17.12 ç‰ˆæœ¬ åå°±å¼€å§‹æ”¯æŒäº†ã€‚å¯¹åº”çš„åŠŸèƒ½å°±æ˜¯Â `docker trust`Â ç›¸å…³çš„å‘½ä»¤ã€‚å¦‚æœä½ æƒ³è¦ä½¿ç”¨ Docker Content Trust è¿™ç§æ–¹æ¡ˆçš„è¯ï¼Œä½ éœ€è¦è‡ªå·±éƒ¨ç½²ä¸€ä¸ªç§æœ‰çš„è®¤è¯æœåŠ¡å™¨ï¼Œä½¿ç”¨Â [Notary](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fnotaryproject%2Fnotary)Â æ¥å®Œæˆã€‚

### å¦ä¸€ç§æ–¹æ¡ˆï¼šCosign

å¦ä¸€ç§æ¯”è¾ƒå…¸å‹çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨Â [Cosign](https://github.com/sigstore/cosign)Â ï¼Œå»å¹´å®ƒå‘å¸ƒäº† v1.0 ç‰ˆæœ¬ï¼Œæ ‡å¿—ç€å…¶å·²ç»è¾¾åˆ°ç”Ÿæˆå¯ç”¨çš„æ ‡å‡†ã€‚ ç›¸å¯¹æ¥è¯´ä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚

```bash
[root@sddk ~]# wget https://github.com/sigstore/cosign/releases/download/v1.5.1/cosign-linux-amd64
[root@sddk ~]# mv cosign-linux-amd64 /usr/local/bin/cosign
[root@sddk ~]# chmod +x /usr/local/bin/cosign
[root@sddk ~]# cosign generate-key-pair
Enter password for private key: 
Enter password for private key again: 
Private key written to cosign.key
Public key written to cosign.pub
[root@sddk ~]# cosign sign --key cosign.key ghcr.io/tao12345666333/argo-cd-demo/argo-cd-demo:93d0e7e591c3c4739f5f4d31b8f9a8ace8e74dfe
[root@sddk ~]# cosign verify --key cosign.pub  ghcr.io/tao12345666333/argo-cd-demo/argo-cd-demo:fa5714f419b3d11dee6ac795e38356e9c3c439cb
```

ç›¸å¯¹æ¥è¯´æ¯” DCT è½»é‡ä¸€äº›ï¼Œä¹Ÿæ¯”è¾ƒå®¹å™¨é›†æˆåˆ° CI/CD pipeline ä¸­ã€‚ä½†æ˜¯ DCT çš„ä¼˜åŠ¿åœ¨ä¸å®ƒæ˜¯é»˜è®¤é›†æˆåœ¨ Docker ä¸­çš„èƒ½åŠ›ï¼Œæ— éœ€å®‰è£…å…¶ä»–çš„å·¥å…·ã€‚åœ¨ä½¿ç”¨æ—¶å€™å¤§å®¶å¯ä»¥è‡ªè¡Œè¿›è¡Œæƒè¡¡ã€‚

## æ€»ç»“

å¯¹äºå®¹å™¨é•œåƒè€Œè¨€ï¼Œæ— è®ºæ˜¯å®¹å™¨é•œåƒçš„å†…å®¹æœ¬èº«ï¼Œè¿˜æ˜¯å®¹å™¨é•œåƒåœ¨åˆ†å‘è¿‡ç¨‹ä¸­çš„å®‰å…¨éƒ½æ˜¯éå¸¸å€¼å¾—å…³æ³¨çš„ã€‚è¿™é‡Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»äº†ä½¿ç”¨ SBOM çš„æ–¹å¼å¯¹å®¹å™¨é•œåƒçš„å†…å®¹è¿›è¡Œå®‰å…¨é˜²æŠ¤ï¼Œä»¥åŠä½¿ç”¨é•œåƒç­¾åè®¤è¯çš„æ–¹å¼å¯¹é•œåƒåˆ†å‘è¿‡ç¨‹è¿›è¡Œå®‰å…¨é˜²æŠ¤ã€‚

è¿™ä¸¤ä¸ªç»´åº¦ï¼Œå‡å¯ä¸å½“å‰ä¼ä¸šä¸­çš„ CI/CD pipeline è¿›è¡Œé›†æˆï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä½¿ç”¨åœºæ™¯ã€‚