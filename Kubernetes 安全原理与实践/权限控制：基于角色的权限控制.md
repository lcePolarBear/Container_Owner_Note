# æƒé™æ§åˆ¶ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶

<aside>
ğŸ’¡ å­¦ä¹ **å¦‚ä½•åˆ©ç”¨ Kubernetes ä¸­åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶æå‡ Kubernetes çš„å®‰å…¨æ€§ã€‚**

</aside>

## **Kubernetes ä¸­ææƒé—®é¢˜**

1. åˆ›å»ºä¸€ä¸ª ClusterRoleBinding å¹¶ applyï¼ˆå®éªŒå®Œåè®°å¾—åˆ é™¤ï¼‰

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: cluster-viewer
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: view
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
```

1. åˆ›å»ºä¸€ä¸ªä»¥`alpine`Â ä½œä¸ºé•œåƒçš„`Pod`

```bash
kubectl run -it alpine-$RANDOM  --image='alpine' -- sh

apk add -q curl

TOKEN=`cat /var/run/secrets/kubernetes.io/serviceaccount/token`

curl -k https://kubernetes.default:443/api/v1/namespaces/kube-system/configmaps/coredns?limit=1 -H "Authorization: Bearer $TOKEN"
```

å¯ä»¥çœ‹åˆ°åœ¨æœ€åä¸€æ­¥ï¼Œç›´æ¥é€šè¿‡ `curl` å‘½ä»¤è¯·æ±‚ Kubernetes çš„ API è®¿é—®åˆ°äº†Â `kube-system` Â å‘½åç©ºé—´ä¸‹çš„ coredns çš„é…ç½®ä¿¡æ¯ã€‚

å°è¯•å»è®¿é—®é›†ç¾¤ä¸­å…¶ä»–é»˜è®¤èµ„æºï¼Œä¼šå‘ç°åŒæ ·èƒ½å¤Ÿæ­£å¸¸è®¿é—®åˆ°ã€‚

 **ä½†æ˜¯ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¤Ÿè¢«è¿™ç§æ–¹å¼è®¿é—®åˆ°**ï¼Œè¿™å°±æ˜¯**ææƒï¼Œ**å³è°ƒç”¨æ–¹å®é™…è·å¾—äº†æ¯”ç®¡ç†å‘˜é¢„æœŸçš„æ›´é«˜æƒé™ã€‚

## kubernetes ä¸­è¯·æ±‚å¤„ç†æµç¨‹

åœ¨ Kubernetes ä¸­æ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦ç»è¿‡ kube-apiserverï¼Œè€Œ kube-apiserver æœ€åŸºç¡€çš„åŠŸèƒ½å°±æ˜¯æŒ‰ç…§è¯·æ±‚è·¯å¾„å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†å’Œè·¯ç”±ã€‚åœ¨æ­¤ä¹‹åï¼Œä¼šåˆ†åˆ«è¿›è¡Œè®¤è¯ï¼ˆAuthenticationï¼‰å’Œæˆæƒï¼ˆAuthorizationï¼‰çš„é€»è¾‘ï¼Œå†ä¹‹åä¼šæœ‰å‡†å…¥æ§åˆ¶å™¨ï¼ˆAdmission controllerï¼‰ç­‰è¿›è¡Œå¤„ç†ï¼Œç»è¿‡è¿™ä¸€ç³»åˆ—å¤„ç†ï¼Œè¯·æ±‚æ‰èƒ½ä¸ etcd ä¸­çš„æ•°æ®è¿›è¡Œäº¤äº’ã€‚

å¯¹äºå…¶ä¸­çš„è®¤è¯ï¼ˆAuthenticationï¼‰éƒ¨åˆ†ï¼ŒKubernetes é»˜è®¤æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ã€‚

1. X509 å®¢æˆ·ç«¯è¯ä¹¦ï¼šè¿™ç§æ–¹å¼ä½¿ç”¨å¾ˆé¢‘ç¹ï¼Œå¤šæ•°æ—¶å€™æˆ‘ä»¬ä½¿ç”¨ kubectl å‘½ä»¤è¡Œå·¥å…·å’Œ Kubernetes é›†ç¾¤äº¤äº’æ—¶å€™ä¹Ÿæ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼è¿›è¡Œè®¤è¯ã€‚

```bash
kubectl config view

apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: DATA+OMITTED
    server: https://192.168.102.241:6443
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: kubernetes-admin
  name: kubernetes-admin@kubernetes
current-context: kubernetes-admin@kubernetes
kind: Config
preferences: {}
users:
- name: kubernetes-admin
  user:
    client-certificate-data: REDACTED
    client-key-data: REDACTED
```

åœ¨Â `users.user`Â ä¸­çœ‹åˆ°äº†Â `client-certificate-data`Â å’ŒÂ `client-key-data`Â å­—æ ·ï¼Œé‚£åŸºæœ¬ä¸Šå°±æ˜¯ä½¿ç”¨ X509 å®¢æˆ·ç«¯è¯ä¹¦è¿›è¡Œè®¤è¯çš„äº†ã€‚

1. Service Account Tokenï¼šè¿™æ˜¯ Kubernetes ä¸­çš„ä¸€ç§é»˜è®¤æœºåˆ¶ã€‚

## Service Account Token

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯è¿›å…¥åˆ°äº†ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ Pod å†…å®Œæˆæƒé™æå‡æ“ä½œçš„ï¼Œè¿™ç§æ–¹å¼åˆ©ç”¨çš„å°±æ˜¯åŸºäº Service Account Token çš„è®¤è¯æ–¹å¼ã€‚

æˆ‘ä»¬ä¹ŸçŸ¥é“é€šå¸¸æƒ…å†µä¸‹ï¼Œè¦è¿›è¡Œè®¤è¯ï¼Œæ˜¯å¿…é¡»è¦æºå¸¦ç”¨æˆ·è®¤è¯å‡­æ®çš„ã€‚ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¦‚ä¸‹æ–¹å¼è®¿é—® Kubernetes çš„ kube-apiserverã€‚

```bash
TOKEN=`cat /var/run/secrets/kubernetes.io/serviceaccount/token`

# å¢åŠ  -k å‚æ•°æ˜¯ä¸ºäº†å¿½ç•¥è¯ä¹¦æ ¡éªŒï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¯ä¹¦åŠ ä¸Š
curl -k https://kubernetes.default:443/api/v1/namespaces/kube-system/configmaps/coredns?limit=1 -H "Authorization: Bearer $TOKEN"
```

æ­¤å¤„å¢åŠ äº†Â `Authorization: Bearer $TOKEN` çš„è¯·æ±‚å¤´ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„è®¤è¯å‡­æ®ã€‚å…¶ä¸­Â `$TOKEN` åŒ…å«äº†å¾ˆå¤šå…³é”®çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒå½“ä¸­çš„å…·ä½“å†…å®¹ã€‚

```bash
cat /var/run/secrets/kubernetes.io/serviceaccount/token

eyJhbGciOiJSUzI1NiIsImtpZCI6IjdDTFlOZWZqWVhwMFNhdEs4MmdUcWlCWC1KMVVEb0x4V1hBcEZUTHZhR2MifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNjc1NzQ3OTU2LCJpYXQiOjE2NDQyMTE5NTYsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicG9kIjp7Im5hbWUiOiJhbHBpbmUtMTQ2NzAiLCJ1aWQiOiI0MmU4M2FlYS0zYzAzLTRiNWUtYTIzNy1mNWY0MWRhNjI1OGYifSwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImRlZmF1bHQiLCJ1aWQiOiI3ODhkM2ZmMi0zNjNmLTRjYjAtYTYyNS0wYzkxOTE3OWFlN2MifSwid2FybmFmdGVyIjoxNjQ0MjE1NTYzfSwibmJmIjoxNjQ0MjExOTU2LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpkZWZhdWx0In0.MuxcXagDgfxrRdL0XdJsimO5haPuhM2tFziNIE-bwjlOmZcwYR31UL0nrftpJ5fl8kXJUhS03cjtMQTJU8R1_pJzt-kaa4g4bvx1KMTiJEY3BL8dgK6wVHnreBfhwBDE2ogMCSiQh90p6IV1F7PEr84zIDGfPBvyTlo4gFyn4NefP829twjRnK4FxudbrK2sJq0glmjCDXpXB792JnB3XjL4M9cZ4-A8Ha7j-I5n0vdQGc2wCex5ncMFXyKHWZu2kzujeXxQphGbxhsgWVFZq3-lHOAWel5dlU8O1gdNJBuF77LWJP2rBm0jYSRxa916Y02VQv5fwV8WDZKjEzR2Fw
```

æˆ‘ä»¬ä½¿ç”¨ [token.dev/](http://token.dev/) è¿™ä¸ªå·¥å…·è¿›è¡Œåœ¨çº¿è§£ç æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ª Token ä¸­åŒ…å«äº†å¾ˆå¤šä¿¡æ¯

- å®ƒç”±Â `https://kubernetes.default.svc.cluster.local`Â ç­¾å‘å’Œä½¿ç”¨ï¼Œè¿™å…¶å®å°±æ˜¯ Kubernetes çš„kube-apiserver åœ°å€ï¼Œåœ¨ kubernetes ç¾¤é›†ä¸­çš„ä»»æ„ Pod éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€è®¿é—® kube-apiserverï¼›
- è¿™æ˜¯ç”± default å‘½åç©ºé—´ä¸­åä¸º alpine-14670 çš„ Pod åœ¨ä½¿ç”¨ï¼›
- è¿™ä¸ª Pod ä½¿ç”¨çš„ Service Account çš„åå­—ä¸º default ï¼Œå…¶ä¸­ sub ä¸º `system:serviceaccount:default:default`ï¼›
- å®ƒä½¿ç”¨çš„åŠ å¯†ç®—æ³•ä¸ºÂ `RS256`

è¿™å…¶ä¸­ Pod ä½¿ç”¨äº†åä¸º `default` çš„ Service Account ï¼Œä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰æ‰‹åŠ¨çš„æŒ‡å®šè¦ä½¿ç”¨è¯¥ Service Account

## Service Account

Service Account æ˜¯ Kubernetes é›†ç¾¤å†…è®¤è¯æœ€å…³é”®çš„ä¸€ç¯ï¼Œå®ƒæ˜¯è¿›è¡Œ JWT è®¤è¯çš„ä¸»ä½“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes ä¼šä¸ºæ¯ä¸ª Pod æŒ‡å®šä¸€ä¸ªåä¸ºÂ `default` çš„ Service Accountï¼Œå¹¶ä¸”åœ¨ Pod å†…æŒ‚è½½è¯¥ Service Account ä¸ kube-apiserver çš„è®¤è¯å‡­æ®ã€‚

ä¿å­˜å¹¶åˆ›å»ºå¦‚ä¸‹ Pod èµ„æº

```bash
apiVersion: v1
kind: Pod
metadata:
  labels:
    run: alpine-with-sa
  name: alpine-with-sa
spec:
  containers:
  - args:
    - sleep
    - "9999"
    image: alpine
    name: alpine-with-sa
```

æ¥ä¸‹æ¥æŸ¥çœ‹å…¶å®Œæ•´ä¿¡æ¯

```bash
kubectl  get pods alpine-with-sa -o yaml
```

å¯ä»¥çœ‹åˆ°ç¡®å®é»˜è®¤æºå¸¦äº†ä¸€ä¸ªåä¸ºÂ `default` Â çš„ Service Accountã€‚

åªè¦åœ¨ `spec` ä¸­ä¸ºå®ƒå¢åŠ ä¸€ä¸ªÂ `automountServiceAccountToken: false` Â çš„é…ç½®é¡¹ï¼Œå°±å¯ä»¥ä¸è®© Pod æºå¸¦è®¤è¯ä¿¡æ¯ã€‚

**å¦‚æœæˆ‘ä»¬ç¡®è®¤ Pod æ˜¯å®Œå…¨ä¸éœ€è¦æŒ‚è½½ ServiceAccount Token çš„è¯ï¼Œä¾¿å¯ä»¥é€šè¿‡ä¸Šè¿°æ–¹å¼ç¦æ­¢å…¶è‡ªåŠ¨æŒ‚è½½**ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯ç”¨äºæå‡å®‰å…¨æ€§çš„åŠæ³•ã€‚ï¼ˆä¹Ÿå¯ä»¥ç»´æŒ ServiceAccount çš„è‡ªåŠ¨æŒ‚è½½ï¼Œç„¶åé€šè¿‡ RBAC ç­‰æœºåˆ¶è¿›è¡Œæƒé™æ§åˆ¶ï¼‰

## RBAC

Kubernetes ä¸­æ”¯æŒå¤šç§æˆæƒæ¨¡å¼ï¼Œå½“å‰ä½¿ç”¨æœ€å¤šçš„ä¾¿æ˜¯ RBACï¼ˆRole-Based Access Controlï¼‰ã€‚

ç»è¿‡ä¸Šè¿°å†…å®¹ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œæœ¬èŠ‚å¼€å§‹çš„ç¤ºä¾‹ä¸­ï¼Œè¦åœ¨ Pod å†…å®Œæˆææƒæ“ä½œï¼Œä½¿ç”¨çš„è®¤è¯ä¿¡æ¯æ¥è‡ªäº ServiceAccount åŠå…¶ Token ã€‚é‚£å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ï¼šè¿™ä¸ª ServiceAccount å¦‚ä½•è¿›è¡Œæˆæƒï¼Ÿå®ƒçš„æƒé™å¦‚ä½•æ§åˆ¶ï¼Ÿ

åœ¨ Kubernetes é›†ç¾¤ä¸­æƒ³è¦ä¸º ServiceAccount è¿›è¡Œæˆæƒï¼Œä¸»è¦ä¼šæ¶‰åŠåˆ°ä»¥ä¸‹ä¸¤ç±»èµ„æºã€‚

- â€¢ `Role`Â å’ŒÂ `ClusterRole`ï¼šè¿™ä¸¤ä¸ªèµ„æºçš„åŒºåˆ«æ˜¯å‰è€…ä¸º Namespace èŒƒå›´çš„ï¼Œåè€…æ˜¯ Cluster çº§åˆ«çš„ã€‚å®ƒä»¬ç”¨äºå®šä¹‰è§’è‰²ï¼Œä»¥åŠè§’è‰²æ‰€å…·å¤‡çš„æƒé™ã€‚
- â€¢ `RoleBinding`Â å’ŒÂ `ClusterRoleBinding`ï¼šè¿™ä¸¤ä¸ªèµ„æºçš„åŒºåˆ«æ˜¯å‰è€…ä¸º Namespace èŒƒå›´çš„ï¼Œåè€…æ˜¯ Cluster çº§åˆ«çš„ã€‚å®ƒä»¬ç”¨äºå°†è§’è‰²å’Œ Kubernetes ä¸­å…·ä½“çš„"ç”¨æˆ·"/"èº«ä»½"è¿›è¡Œç»‘å®šï¼Œå®Œæˆæˆæƒã€‚

åˆ›å»ºä¸€ä¸ª Cluster çº§åˆ«çš„ ClusterRoleBinding èµ„æº

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: cluster-viewer
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: view
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
```

å®ƒçš„æ ¸å¿ƒåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†

- `subjects`ï¼šè¿™æ˜¯è¢«æˆæƒçš„ä¸»ä½“ï¼Œæ”¯æŒåŒæ—¶ä¸ºå¤šä¸ªä¸»ä½“æˆäºˆæƒé™ã€‚
- `roleRef` ï¼šè¿™æ˜¯æˆæƒä½¿ç”¨çš„è§’è‰²ï¼Œ`roleRef.kind` éœ€è¦ä¸å½“å‰çš„èµ„æºç±»å‹ä¿æŒä¸€è‡´ï¼Œå³ ClusterRoleBinding çš„ roleRef.kind ä¸º ClusterRole ï¼ŒRoleBinding çš„ roleRef.kind ä¸º Roleã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes å·²ç»å†…ç½®äº†å¾ˆå¤š ClusterRole ä¾›é›†ç¾¤ä½¿ç”¨ï¼Œå…¶ä¸­å¤§å¤šæ•°éƒ½æ˜¯ä»¥Â `system:` å¼€å¤´çš„ã€‚å…¶ä¸­æœ‰ 4 ä¸ªç‰¹æ®Šçš„

- cluster-adminï¼šç¾¤é›†ç®¡ç†å‘˜è§’è‰²ï¼Œå…è®¸å¯¹ kubernetes æ‰€æœ‰çš„èµ„æºè¿›è¡Œæ“ä½œ
- adminï¼šå…è®¸å¯¹ namespace ä¸­çš„èµ„æºè¿›è¡Œä»»æ„çš„è¯»å†™æ“ä½œï¼Œä»¥åŠä¸€äº›èµ„æºçš„åˆ é™¤ï¼Œä¹Ÿæ”¯æŒå¯¹ Role å’Œ RoleBinding èµ„æºçš„æ“ä½œï¼Œä½†æ˜¯ä¸èƒ½æ“ä½œ namespac èµ„æºæœ¬èº«
- editï¼šå…è®¸è¿›è¡Œè¯»å†™æ“ä½œï¼Œä½†ä¸èƒ½æ“ä½œ Role å’Œ RoleBinding ç­‰èµ„æº
- viewï¼šå…è®¸è¿›è¡Œåªè¯»æ“ä½œï¼Œä½†ä¸èƒ½è®¿é—® Role å’Œ RoleBinding ç­‰èµ„æº

æ‰€ä»¥åœ¨æœ¬èŠ‚å¼€å§‹çš„ææƒç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†Â `view` è¿™ä¸ªÂ `ClusterRole`Â å’ŒÂ `default`Â è¿™ä¸ªÂ `ServiceAccount`Â è¿›è¡Œäº†ç»‘å®šï¼Œä¸ºå®ƒæˆäºˆäº†åªè¯»æƒé™ï¼Œæ‰€ä»¥åˆ©ç”¨å®ƒçš„èº«ä»½ä¿¡æ¯ï¼Œå¯ä»¥éšæ„åœ°é€šè¿‡ Kubernetes çš„ API è·å–åˆ°å„ç±»ä¿¡æ¯ã€‚

`Role` Â å’ŒÂ `ClusterRole` Â çš„å®šä¹‰éƒ½æ¯”è¾ƒç®€å•ï¼Œå‚è€ƒ Kubernetes æä¾›çš„è¿™å‡ ä¸ªé¢„è®¾çš„è§’è‰²é…ç½®å³å¯æ»¡è¶³ä½ ç»å¤§å¤šæ•°çš„éœ€æ±‚ã€‚

åœ¨å®é™…å®šä¹‰æ—¶ï¼Œéœ€è¦æ³¨æ„**ä½¿ç”¨æœ€å°æƒé™çš„åŸåˆ™**ï¼Œä»…æˆæƒçœŸæ­£éœ€è¦çš„æƒé™ã€‚

## æƒé™æ ¡éªŒ

kubectl æä¾›äº†ä¸€ä¸ª auth çš„å­å‘½ä»¤å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿè¿›è¡Œ kubernetes ä¸­æƒé™çš„æ ¡éªŒ

Role é…ç½®ï¼š

```yaml
# test-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: test-role
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  - secrets
  - serviceaccounts
  - services
  verbs:
  - create
  - delete
  - update
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - create
  - delete
```

ServiceAccount é…ç½®ï¼š

```yaml
# test-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: test
  namespace: default
```

RoleBinding é…ç½®ï¼š

```yaml
# test-rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: test-role-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: test-role
subjects:
- kind: ServiceAccount
  name: test
  namespace: default
```

é‚£ä¹ˆå¦‚ä½•å»éªŒè¯åˆšæ‰åˆ›å»ºçš„Â `test`Â è¿™ä¸ª ServiceAccount æƒé™æ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿ

```yaml
kubectl auth can-i  get configmap -n default --as system:serviceaccount:default:test
no

kubectl auth can-i  create configmap -n default --as system:serviceaccount:default:test
yes
```

å¦‚ä¸Šæ‰€ç¤ºï¼Œé€šè¿‡ç»™Â `kubectl auth can-i`Â å¢åŠ Â `--as system:serviceaccount:default:test`Â çš„é€‰é¡¹å³å¯ï¼Œè¿™ä¸ªæ ¼å¼æ˜¯Â `system:serviceaccount:<Your Namespace name>:<Your ServiceAccount name>`Â ã€‚ç»è¿‡æµ‹è¯•ä¹Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®é™…çš„æƒé™ä¸æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æƒé™æ˜¯ä¸€è‡´çš„ã€‚

## æ€»ç»“

æˆ‘ä»¬ä¸»è¦åœ¨ä»‹ç» Kubernetes ä¸­åŸºäº RBAC çš„æƒé™æ§åˆ¶ã€‚

å…¶ä¸­é€šè¿‡ä¸€ä¸ªææƒçš„ç¤ºä¾‹å¼€å§‹ï¼Œä¸ºä½ é€æ­¥ä»‹ç»äº† Kubernetes ä¸­è¯·æ±‚å¤„ç†çš„æµç¨‹ï¼ŒKubernetes é›†ç¾¤ä¸­åŸºäº ServiceAccount Token çš„è®¤è¯æ–¹å¼ï¼Œä»¥åŠ RBAC çš„æˆæƒï¼Œè¿˜æœ‰å¦‚ä½•å»æ ¡éªŒ Kubernetes ä¸­çš„æˆæƒæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

åœ¨å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šæ¶‰åŠåˆ°ä¸€äº› ServiceAccount çš„ç‰¹æ®Šç”¨é€”ï¼Œæ¯”å¦‚ä¸º ServiceAccount å¢åŠ æ‹‰å–å®¹å™¨é•œåƒçš„å‡­è¯ç­‰ã€‚ä½†æ˜¯æ•´ä½“çš„è¿‡ç¨‹å’ŒåŸç†åœ¨æœ¬èŠ‚ä¸­å‡å·²ç»è¦†ç›–åˆ°äº†ã€‚

å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå°¤å…¶æ˜¯ç°åœ¨å¼€å‘/éƒ¨ç½²äº†è¶Šæ¥è¶Šå¤šçš„ Controllerã€Operatorï¼Œå¯¹äº RBAC æˆæƒæ–¹é¢æ›´åŠ éœ€è¦è°¨æ…ï¼Œå¦åˆ™å¾ˆå®¹æ˜“ç»™æ”»å‡»è€…ç•™ä¸‹å¯ä¹˜ä¹‹æœºã€‚